@page "/standardture"
@using TANA.Application.DTOs;
@using TANA.Application.Interface
@inject ITurService TurService
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<Language> L
@rendermode InteractiveServer

<h3>@L["CreateStandardTrip"]</h3>

<input @bind="navn" placeholder="@L["Title"]" />
<input @bind="description" placeholder="@L["Description"]" />
<input type="number" @bind="pris" placeholder="@L["Price"]" />
<input type="number" @bind="dage" placeholder="@L["NumberOfDays"]" />
<button @onclick="CreateTur">@L["Create"]</button>

@if (ture.Any())
{
    <h4>@L["ExistingTrips"]:</h4>
    <ul>
        @foreach (var t in ture)
        {
            <li>@t.Navn – @t.Pris kr. – @t.Dage dage</li>
            <button @onclick="() => DeleteTurAsync(t.Id)">@L["Delete"]</button>
        }
    </ul>
}

@code {
    string navn, description;
    int pris;
    int dage;

    List<TurDto> ture = new();

    protected override async Task OnInitializedAsync()
    {
        await HentTureAsync();
    }

    private async Task CreateTur()
    {
        await TurService.CreateTurAsync(navn, description, pris, dage);
        await HentTureAsync(); // Opdater visning
    }

    private async Task HentTureAsync()
    {
        ture = await TurService.GetAllTurAsync();
    }

    private async Task DeleteTurAsync(int id)
    {
        await TurService.DeleteTurAsync(id); // ← korrekt service
        await HentTureAsync(); // Opdater listen
    }
}